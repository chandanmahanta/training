scala> val retailRDD = sc.textFile("D:/scala/RetailData/*")
retailRDD: org.apache.spark.rdd.RDD[String] = D:/scala/RetailData/* MapPartitionsRDD[1] at textFile at <console>:24

scala> retailRDD.count
res0: Long = 817741

scala> val custRDD = retailRDD.map(x=> (x.split(";")(8).toInt))
custRDD: org.apache.spark.rdd.RDD[Int] = MapPartitionsRDD[2] at map at <console>:25

scala> custRDD.count
res1: Long = 817741

scala> val maxvalue = custRDD.max
maxvalue: Int = 444000

scala> val maxcustRDD = retailRDD.filter(m=>(m.split(";")(8).toInt==maxvalue))
maxcustRDD: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[7] at filter at <console>:27

scala> maxcustRDD.take(10).foreach(println)
2001-02-17 00:00:00;01622362  ;A ;F ;100516;4711588210441;800;432000;444000

scala> val custidRDD = maxcustRDD.map(m=>m.split(";")(1).toInt)
custidRDD: org.apache.spark.rdd.RDD[Int] = MapPartitionsRDD[8] at map at <console>:25

scala> val custidRDD = maxcustRDD.map(m=>m.split(";")(1).toString)
custidRDD: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[10] at map at <console>:25

scala> custidRDD.take(10).foreach(println)
01622362

scala>


 
<init>                           DRIVER_IDENTIFIER                LEGACY_DRIVER_IDENTIFIER         RDD_SCOPE_KEY                    RDD_SCOPE_NO_OVERRIDE_KEY        
SPARK_JOB_DESCRIPTION            SPARK_JOB_GROUP_ID               SPARK_JOB_INTERRUPT_ON_CANCEL    StringToColumn                   _sqlContext                      
abs                              acos                             add_months                       approxCountDistinct              array                            
array_contains                   asc                              ascii                            asin                             atan                             
atan2                            avg                              base64                           bin                              bitwiseNOT                       
boolToBoolWritable               booleanWritableConverter         broadcast                        bytesToBytesWritable             bytesWritableConverter           
callUDF                          callUdf                          cbrt                             ceil                             classOf                          
clearActiveContext               clone                            coalesce                         col                              collect_list                     
collect_set                      column                           concat                           concat_ws                        conv                             
corr                             cos                              cosh                             count                            countDistinct                    
crc32                            cumeDist                         cume_dist                        current_date                     current_timestamp                
date_add                         date_format                      date_sub                         datediff                         dayofmonth                       
dayofyear                        decode                           denseRank                        dense_rank                       desc                             
doubleRDDToDoubleRDDFunctions    doubleToDoubleWritable           doubleWritableConverter          encode                           eq                               
equals                           exp                              explode                          expm1                            expr                             
factorial                        finalize                         first                            floatToFloatWritable             floatWritableConverter           
floor                            format_number                    format_string                    from_unixtime                    from_utc_timestamp               
getClass                         getOrCreate                      get_json_object                  greatest                         hashCode                         
hex                              hour                             hypot                            initcap                          initializeLogIfNecessary         
initializeLogging                inputFileName                    input_file_name                  instr                            intRddToDataFrameHolder          
intToIntWritable                 intWritableConverter             isNaN                            isTraceEnabled                   isnan                            
isnull                           jarOfClass                       jarOfObject                      json_tuple                       kurtosis                         
lag                              last                             last_day                         lead                             least                            
length                           levenshtein                      lit                              localSeqToDataFrameHolder        localSeqToDatasetHolder          
locate                           log                              log10                            log1p                            log2                             
logDebug                         logError                         logInfo                          logName                          logTrace                         
logWarning                       longRddToDataFrameHolder         longToLongWritable               longWritableConverter            lower                            
lpad                             ltrim                            markPartiallyConstructed         max                              md5                              
mean                             min                              minute                           monotonicallyIncreasingId        monotonically_increasing_id      
month                            months_between                   nanvl                            ne                               negate                           
newBooleanArrayEncoder           newBooleanEncoder                newBooleanSeqEncoder             newByteArrayEncoder              newByteEncoder                   
newByteSeqEncoder                newDoubleArrayEncoder            newDoubleEncoder                 newDoubleSeqEncoder              newFloatArrayEncoder             
newFloatEncoder                  newFloatSeqEncoder               newIntArrayEncoder               newIntEncoder                    newIntSeqEncoder                 
newLongArrayEncoder              newLongEncoder                   newLongSeqEncoder                newProductArrayEncoder           newProductEncoder                
newProductSeqEncoder             newShortArrayEncoder             newShortEncoder                  newShortSeqEncoder               newStringArrayEncoder            
newStringEncoder                 newStringSeqEncoder              next_day                         not                              notify                           
notifyAll                        ntile                            numDriverCores                   numericRDDToDoubleRDDFunctions   percentRank                      
percent_rank                     pmod                             pow                              quarter                          rand                             
randn                            rank                             rddToAsyncRDDActions             rddToDataFrameHolder             rddToDatasetHolder               
rddToOrderedRDDFunctions         rddToPairRDDFunctions            rddToSequenceFileRDDFunctions    regexp_extract                   regexp_replace                   
repeat                           reverse                          rint                             round                            rowNumber                        
row_number                       rpad                             rtrim                            sc                               second                           
setActiveContext                 sha1                             sha2                             shiftLeft                        shiftRight                       
shiftRightUnsigned               signum                           sin                              sinh                             size                             
skewness                         sort_array                       soundex                          sparkPartitionId                 spark_partition_id               
split                            sql                              sqlContext                       sqrt                             stddev                           
stddev_pop                       stddev_samp                      stringRddToDataFrameHolder       stringToText                     stringWritableConverter          
struct                           substring                        substring_index                  sum                              sumDistinct                      
symbolToColumn                   synchronized                     tan                              tanh                             toDegrees                        
toRadians                        toString                         to_date                          to_utc_timestamp                 translate                        
trim                             trunc                            udf                              unbase64                         unhex                            
unix_timestamp                   updatedConf                      upper                            var_pop                          var_samp                         
variance                         wait                             weekofyear                       when                             writableWritableConverter        
year                     